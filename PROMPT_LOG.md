# PROMPT_LOG.md - AIへの指示履歴

このファイルは、開発中にAIアシスタントへ出した主要な指示をまとめたものです。

---

## v0.2.1で実施した修正プロンプト
- ウィンドウ状態の完全復元。終了時の「最大化状態」「ウィンドウサイズ」「位置」「分割バーの位置」を記憶し、次回起動時に復元する。
- 録画ツールの起動を1つに制限する
- 出力のとき、MP4だけでなく、GIF形式で書き出す機能を増やす
- 録画のとき、マウスポインタの軌跡を動画の時刻とフレームとXとY座標でテキストファイルに記録して、録画完了と同時に動画と同じ名前で同じ場所に tsv形式で保存するようにして
- 録画の画質を選べるようにして。既定値の画質は今より高くして
- 「既に起動している場合は、警告を表示して終了」については、そうではなく開いているウィンドウを前面に表示するだけでOK
- マウスの軌跡のTSVを記録したとして、動画再生時は同名のTSVを読み込んでマウスポインタの描画を再現するかどうか選ぶチェックボックスを追加して
- 「既に起動している場合は、警告を表示して終了」については、そうではなく開いているウィンドウを前面に表示するだけでOK
- マウスの軌跡のTSVを記録したとして、動画再生時は同名のTSVを読み込んでマウスポインタの描画を再現するかどうか選ぶチェックボックスを追加して
- ボタンを押し込んでいる間の色がグレーの標準色に戻っている。
- UIをテーマカラーとしてアプリの設定ファイルに保存して、起動時に読み込むようにしてください。
- ボタンを押した時の処理を threading を使って別スレッドに逃がしたいです。GUIがフリーズしないように、重い処理を非同期で実行するコードパターンに書き換えてください。
- ウィンドウが表示されきった後（.after() メソッドなどを使用）に、シークバーのレイアウトを再計算・再描画する処理を追加したいです。起動の100ms後にリサイズ処理を走らせるコードを書いて。
- クロップ矩形をテーマカラーで定義できるように変更してください。線種、色、太さ（1ドットに対する太さ）など（未選択時：破線、選択時：実線）
- 設定保存、設定確認、設定再読み込みボタンで使用する設定ファイルは、アプリの実行ファイルと同じフォルダに配置するものとして確認修正してください。
- 「出力」フレームを整理して「設定」「PNG出力・コピー」「動画出力」の３つのフレーム（横並び）になおしてください。
- 動画再生・出力時にカーソルの位置を強調するための赤丸などをON/OFFで追加できるようにしてください。
- 新しい動画を開いた時に設定ファイルがない場合のStart、Endの既定値は、0と動画の最後までにしてください。
- Ctrl+Sで現在の囲っている範囲のフレームをPNGとして保存する機能を追加してください。
- 録画対象でウィンドウを選んでいるとき、ウィンドウの選択肢を名前の部分一致で絞り込める機能を追加してください。
- TSVに左右中のクリックボタンを押した瞬間の座標を記録する機能を追加してください。
- TSVに押されたショートカットキーを記録する機能を追加してください。

---

## 2026-02-05 (v0.2.2 開発)

- 初期色のままのすべてのボタンに色を付けて。
- ツールチップが設定されていないボタンにツールチップを追加して（ショートカットキーや解説など）
- 編集画面の動画キャンバス外の背景色を録画フォームと同じグレーにして
- アプリケーション設定で、ボタンや背景色などのデザインテーマを保存するようにして
- クロップ枠線の初期色は、未選択が橙破線で、選択時が赤破線にしてください。
- 四つ角のドットの色と大きさを設定ファイルで定義してください。
- クリック時のクロップ範囲サイズ変更を検知する太さも設定に追加してください。
- クロップの輪郭にマウスが乗った時のサイズ変更のクリックを検知するマージンですが、動画の拡大倍率によって変えてください。現在表示している線の太さ+設定値の数値が検知範囲です。そのため既定値は現在の値より少し減らしてください。

- Altキーを押しながらクロップのサイズ変更をしたら、10で割り切れる単位で変化するようにしてください。
- 動画の表示倍率を右上の解像度の隣に表示して
- ホイールで拡大縮小するときに、予定倍率が95%～105%になるとき100%にして
- X,Y,幅、高さのテキストボックスをStartのテキストと同じ高さまで大きくして
- マウスポインタをクロップ範囲内や枠線上を出入りする度に適切なものに変化させて

### クロップ枠線の設定
- 「枠線の色のデフォルトをオレンジにして」
- 「フォーカス状態（選択中）では赤い実線、ホバー状態では赤い破線、デフォルトではオレンジ破線にして」
- 「config.py のテーマ設定名を crop_default_linecolor / crop_focused_linecolor / crop_hover_linecolor のように統一して」

### 設定ファイル仕様変更
- 「古い設定名 (crop_color_unfocused, crop_dash_unfocused 等) から新しい設定名への自動移行 (migration) をサポートして」
- 「config.py に migration_map を追加して古い設定を新しいキー名に変換」

### ズーム機能の改善
- 「ホイールズームを100%にするにはレベル制にして」
- 「ズームするときビデオの中心ではなくキャンバスに映っているエリアを合わせて」

### UI視認性の向上
- 「X,Y,幅,高さのテキストボックスをStartのテキストと同じ高さまで大きくして」
- 「初期色のままのボタンにカラフルな色を付けて」
- 「戻す 進む ボタンを絵文字に変更。ボタンの色を他のハイコントラストのものにかえて」

### バグ修正
- ScreenRecorderApp で video_fps が未定義でクラッシュするバグを修正

---

## 2026-02-07 (v0.2.3 開発)

### 機能追加・改善
- 「右上のパネル付近などに、動画の秒間フレーム数であるFPSを表示して欲しい」
- 「png_compression や check_prev_next, check_duplicate, 再生設定（速度、区間、ループ、往復）, 軌跡表示は動画ごとに保存せず、アプリの共通設定にして欲しい」
- 「各所のStartの "#00aa00" という色はアプリの設定で themeに start_color_bg で共通化してください。同様にendについても共通化してください」

### バグ修正・操作性向上
- 「『動画を選択』などのボタンが、時々反応しなくなる問題を修正して（特に赤枠操作後）」
- 「on_canvas_motionの中のコメントを日本語にして。ロックされているときは操作不能を意味するマウスカーソルアイコン（禁止マーク）に変えて」
- 「録画ツールでDeleteキーや削除をおしたとき、メインウィンドウが前に出てきてしまう。録画ツールのウィンドウが前にいて欲しい」

