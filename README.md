# 動画クリップ取得ツール

このツールは、ローカルの動画からフレームを切り出したり、トリミング範囲を指定してクリップを作成するための GUI アプリです。

## バージョン:
 0.1

## 開発者:
 ことりちゅん

## 主な機能:

### 動画再生関連:
- 動画再生 / 一時停止（Space）
- 区間再生・ループ再生・往復再生
- 再生速度の変更（-9.9 ～ 9.9 ホイール操作可）
- 再生位置の変更（0.1s移動:←,→、 1s移動:Ctrl+←,→、開始・終了位置移動:Home,End、先頭・末尾移動:Ctrl+Home,End）
- 表示映像の拡大（マウスホイール回転）
- 表示映像の移動（中クリック…マウスホイールボタンのドラッグ）

### トリミング関連:
- 再生・書き出しの開始位置、終了位置の指定

### クロップ関連:
- クロップ作成（左クリックでドラッグ）
- クロップ移動（赤枠内を右クリックでドラッグ）
- クロップリサイズ（輪郭をドラッグ）
- クロップ変更のUndo/Redo（Ctrl+Z / Ctrl+Y）
- 解像度プリセットの選択、追加・保存・削除

### 出力関連:
- 現在表示中のクロップ範囲を画像としてクリップボードにコピー（Ctrl+C）
- 指定時間帯の各フレームのPNG保存
- 変化したフレームのみをPNG保存（本命の機能ですが、まだ不安定です）
- 指定時間帯の指定矩形内のMP4保存

## 使い方:
1. `video_frame_cropper.exe` を実行します。
2. 「動画を開く」からファイルを選択します。
3. シークバーや Start/End コントロールでトリミング範囲を指定します。
4. クロップ矩形を調整します。
5. 右下のボタンで「PNG保存」や「動画保存」を行います。

## 推しポイント: 
- 動画を元に編集を行うので、最初に1回だけ画面録画の操作をして、後からマニュアル作成用の切り出しに集中できるというのがポイントです。
- 先に録画してしまうのでスタートメニューや右クリックメニューを撮りたい時の煩雑さがありません。
- 映像を拡大してクロップ範囲を指定できるので、ありがちな「ペイントに貼って微調整」が必要ありません。（たぶん）
- プリセットから利用頻度の高いクロップ範囲を数値で指定できるため、ぴったりサイズの画像の抽出が容易です。
- クロップ範囲は、GUIでマウスドラッグで選ぶことも、数値（X、Y、Width、Height）で指定することもできるので、手軽な操作と厳密な調整の両方に対応できます。
- クロップ範囲を動かさずに再生時間だけ進めれば、アプリの同じ地点の同じ大きさのスクショが取り放題です。
- PNG出力では映像の変化が止まった地点を自動選出して書き出すことが可能です。これにより録画中にしばらくマウスポインタを停止させるだけで撮影ポイントとすることができます。（でも、まだ挙動がかなり怪しいです）

## 設定値: 
- このツールで行った設定は、対象動画ファイルと同じフォルダに `動画ファイルの名前.settings.json` で保存され、開いたとき自動で読み込まれます。
- 前回開いていたファイルや解像度プリセットは、exeと同じフォルダに `video_frame_cropper_config.json` で保存され、起動時に自動で読み込まれます。

## その他： 
 このツールは、当初Option Explicit氏が開発した試作品を改造したものとなります。

## 更新履歴: 
- 2026/2/2 試作品バージョン0.1公開

## メモ
- Pythonのコーディングは、ほぼ頼りなので、コード品質については期待しないでください。
- 1ファイルのexeにビルド済みなので、起動するだけで使えると思います。
- （なぜか）たまに再生など各ボタンが無反応になります。他のボタンを押すと治ったりします。謎すぎて困ってます。
- 起動時にシークバーの大きさが小さいバグあります。
- 起動時にウィンドウの縦高が足りないので自分で大きくしてください。
