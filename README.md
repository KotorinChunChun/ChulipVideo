# ChulipVideo (旧: 動画クリップ取得ツール)

このツールは、動画から指定範囲の静止画像を切り出したり、タイムラインから時間帯を指定して、変化した地点の画像集を作成するアプリです。

アプリの操作マニュアルや、ネットワーク・サーバー設定を変更したときの作業報告書作成の効率化のために開発しました。

## ダウンロード:
 v0.2.3-beta : [ダウンロード](https://github.com/KotorinChunChun/ChulipVideo/releases/download/v0.2.x/ChulipVideo_v0.2.3-beta.zip)

 開発中のベータ版につき多数の不具合が含まれている可能性が高い点と、アップデートで予告なく設定ファイルの仕様変更が入る点に注意してご利用ください。

 不具合報告・機能追加提案などはプルリクまたは[Twitter](https://x.com/KotorinChunChun)までどうぞ

## 開発者:
 ことりちゅん

## 主な機能:

### 録画・ソース関連:
- **[NEW]** デスクトップ録画ツール（左上の「録画ツール」ボタンから起動）
    - デスクトップ全体または指定ウィンドウの録画
    - WGCによる選択したウィンドウだけの録画
    - 録画した動画の名前管理、再生、クリップ取得のソースとして連携

### 動画再生関連:
- 動画再生 / 一時停止（Space）
- 区間再生・ループ再生・往復再生
- 再生速度の変更（-9.9 ～ 9.9 ホイール操作可）
- 再生位置の変更（0.1s移動:←,→、 1s移動:Ctrl+←,→、開始・終了位置移動:Home,End、先頭・末尾移動:Ctrl+Home,End）
- 表示映像の拡大（マウスホイール回転）
- 表示映像の移動（中クリック…マウスホイールボタンのドラッグ）
- **[NEW]** 入力操作の可視化（ON/OFF可能なオーバーレイ表示）
    - マウスポインタの描画とクリック時の波紋演出
    - マウス・ショートカットキー入力履歴の字幕表示（スタッキング対応、フェードアウト演出）

### トリミング関連:
- 再生・書き出しの開始位置、終了位置の指定

### クロップ関連:
- クロップ作成（左クリックでドラッグ）
- クロップ移動（赤枠内を右クリックでドラッグ）
- クロップリサイズ（輪郭をドラッグ）
- クロップ変更の戻す/進む（Ctrl+Z / Ctrl+Y）
- 解像度プリセットの選択、追加・保存・削除

### 出力関連:
- クリック演出やキー入力字幕表示のON/OFF
- 現在表示中の映像を画像としてクリップボードにコピー（Ctrl+C）
- 指定時間帯の各フレームのPNG保存
- 変化したフレームのみをPNG保存（本命機能ですが、まだ満足のいく結果が得られていません）
- 指定時間帯の指定矩形内のGIF/MP4保存（おまけ機能です）

### テーマ・字幕・演出設定:
- マウスポインタクリック演出、マウス・ショートカットキー入力字幕、外観テーマをカスタマイズ可能
- 設定ダイアログ上のプレビューウィンドウで実際の入力を試しながら表示時間や外観を調整可能

## 使い方:
1. `ChulipVideo.exe` を実行します。
2. 「動画を選択」からファイルを選択します。
3. シークバーや Start/End コントロールでトリミング範囲を指定します。
4. クロップ範囲をGUIまたは数値で調整します。
5. 右下のボタンで「PNG保存」や「動画保存」を行います。

各種機能はショートカットキー操作にも対応しています。 [ショートカットキー一覧](README_shortcuts.md) を参照してください。ボタン等にマウスカーソルを合わせるとツールチップでショートカットキーが表示されるようにもなっています。

## 開発の経緯:
- ネットワーク・サーバーの設定変更の報告書を書き残す事が多いのですが、その都度スクショを取って解説・クリック箇所の明示・解像度の統一などを行ってから文章に貼り付けています。
- 設定変更の作業は何時間にも及ぶこともありますが、すべての工程を動画に記録し、スクショの撮り忘れは動画から画像の切り出しで対処しています。
- この作業が煩雑で時間がかかるため、動画から本当に必要なポイントの画像の抽出を手軽に行いたいと思い、このツールを開発しました。
- また、開発・導入したアプリの操作手順書を作成する機会も多いのですが、クリックした地点の明示や入力したキー表示などスクショ以外でやるべき定型作業が多いため、これも動画と同時に入力操作も記録することで例の見ないマニュアル制作に特化したツールができるのではないかと思って改良を進めています。

## 推しポイント: 
- 動画を元に編集を行うので、録画データさえあれば後でマニュアル作成に集中できるというのがポイントです。
- 録画ならスクショのようにスタートメニューや右クリックメニューが消えてしまうということがありません。
- 切り出す範囲をGUIでマウスドラッグで選ぶことも、ドット単位で厳密に指定することもできるので、ありがちな「ペイントに貼って微調整」が不要です。
- プリセットから利用頻度の高い解像度を指定できるため、用途にあったサイズの画像の抽出が容易です。
- クロップ範囲を動かさずに再生時間だけ進めて `Ctrl+C` , `Ctrl+S` で、アプリの同じ地点の同じ大きさのスクショが取り放題です。
- PNG連番保存では、映像の変化が止まった地点を自動的に選出して書き出すことが可能です。これにより操作中の残像や録画中にしばらく考え込んでいた時の映像を丸ごと排除して本当に欲しいショットだけの抽出が可能です。
- 手軽にマウスクリック地点演出やショートカットキー操作字幕を組み込んだ画像・動画が作成できます。

## 設定値: 
- トリム範囲やクロップ位置などの「動画固有の設定」は、対象動画ファイルと同じフォルダに `動画ファイルの名前.settings.json` で保存されます。
- 再生速度、圧縮率、除外設定、解像度プリセットなどの「アプリ共通設定」は、exeと同じフォルダに `ChulipVideo_config.json` で保存され、別の動画でも引き継がれます。

## 細かい仕様解説:

### 実行時パラメータ:

アプリに引数を付けて実行することで、開発中に作った機能縮小版ツールを起動できます。
- chulip  ・・・ 動画編集の標準機能で起動します。
- capchun ・・・ スクリーン録画機能で起動します。
- chunap  ・・・ ウィンドウ調整機能で起動します。

### 編集機能:

- 

### 録画機能:

#### ショートカットキーについて

- 本ツールでは入力操作の検知対象として、あらゆるマウスクリック（左、右、中、サイドボタン2つ、ホイール上下左右）と修飾キー（Shift, Ctrl, Alt, Win）とキーボード入力（Space, Enter, Tab, Esc, Backspace, Delete, 方向キー, F1〜F12, A〜Z, 0〜9, !@#$%^&*()_+-=[]{};':",./<>?`~）を検知します。
    - 中、サイド、ホイール操作や、修飾キーとしてWinも検知対象としてカスタマイズできるツールはあまり多くありません。
- ショートカットキーを画面上に字幕表示するツールは数あれど、アプリ固有の挙動や
- また、画面録画と同時に行う

詳しくは [README_shortcuts.md](README_shortcuts.md) を参照してください。

#### 入力記録について

- 

#### WGCとはなにか
- WGC(Windows Graphics Capture)とは、Windows10から導入された対象のウィンドウだけをキャプチャできる機能です。これを使うと、対象のウィンドウが他のウィンドウで背面に隠れたとしても、そのウィンドウの映像だけを録画できます。
- 対象のウィンドウがデスクトップの範囲外に飛び出しているとしても、黒塗りにならずに録画できます。
- ウィンドウを動かしたときにチラつきが発生しません。
- GPUで処理されるためCPU負荷が低いです。
- 一部の従来方式(BitBlt)ではキャプチャできないアプリもキャプチャできます。
- デスクトップの拡大率が100%でない環境でも正確にキャプチャできます。
#### WGC利用上の注意
- アプリによってはポップアップウィンドウが表示されることがありますが、WGCでは録画されません。また、右クリックメニューなども録画されません。
  - この問題は、難しそうですが、いずれバージョンアップによって解決させるつもりでいます。（子クラスを多重でキャプチャして自力で重ね合わせることによって実現できるはず？）
- WGCで撮影した場合はウィンドウの四方の丸みが消えて直角になっています。

## その他： 
 このツールは、 [Excel-Fun.xls* Discord](https://sites.google.com/view/excel-vba-fun-ytube) の Python雑談部屋 で `Option Explicit氏` が開発した試作品を改造したものとなります。

## 更新履歴: 
- 2026/2/8 v0.2.3 動画FPS表示、バグ修正、ボタンが反応しない不具合修正、マウス・キー入力字幕の実装、アプリ共通設定のUI変更、他窓除外録画(WGC/PrintWindow)の実装
- 2026/2/5 v0.2.2 クロップ解像度が不正確な不具合修正、UIの改善
- 2026/2/3 v0.2.0 録画機能の追加
- 2026/2/2 v0.1.0 クリップ取得ツール試作品公開

## 最後に:
- Python素人がAntigravityを頼りに書いているため、コード品質については期待しないでください。
- Releaseは1ファイルのexeにビルド済みなので、起動するだけで使えると思います。
- ソースコードはMITライセンスで公開しています。
- （少なくとも正式リリースまでは）アプリは商用用途でも無料で公開しますが、寄付・応援は歓迎します。Blog/Twitterなどでお声掛けください。
