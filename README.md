# ChulipVideo (旧: 動画クリップ取得ツール)

このツールは、ローカルの動画からフレームを切り出したり、トリミング範囲を指定してクリップを作成するための GUI アプリです。

## バージョン:
 0.2.3

## 開発者:
 ことりちゅん

## 主な機能:

### 録画・ソース関連:
- **[NEW]** デスクトップ録画ツール（左上の「録画ツール」ボタンから起動）
    - デスクトップ全体または指定ウィンドウの録画
    - WGCによる選択したウィンドウだけの録画
    - 録画した動画の名前管理、再生、クリップ取得のソースとして連携

### 動画再生関連:
- 動画再生 / 一時停止（Space）
- 区間再生・ループ再生・往復再生
- 再生速度の変更（-9.9 ～ 9.9 ホイール操作可）
- 再生位置の変更（0.1s移動:←,→、 1s移動:Ctrl+←,→、開始・終了位置移動:Home,End、先頭・末尾移動:Ctrl+Home,End）
- 表示映像の拡大（マウスホイール回転）
- 表示映像の移動（中クリック…マウスホイールボタンのドラッグ）
- **[NEW]** 入力操作の可視化（ON/OFF可能なオーバーレイ表示）
    - マウスポインタの描画とクリック時の波紋演出
    - マウス・ショートカットキー入力履歴の字幕表示（スタッキング対応、フェードアウト演出）

### トリミング関連:
- 再生・書き出しの開始位置、終了位置の指定

### クロップ関連:
- クロップ作成（左クリックでドラッグ）
- クロップ移動（赤枠内を右クリックでドラッグ）
- クロップリサイズ（輪郭をドラッグ）
- クロップ変更のUndo/Redo（Ctrl+Z / Ctrl+Y）
- 解像度プリセットの選択、追加・保存・削除

### 出力関連:
- 現在表示中のクロップ範囲を画像としてクリップボードにコピー（Ctrl+C）
- 指定時間帯の各フレームのPNG保存
- 変化したフレームのみをPNG保存（本命の機能ですが、まだ不安定です）
- 指定時間帯の指定矩形内のMP4保存

### 詳細設定（マウスポインタ・マウス・キーボード入力・テーマ）:
- **[NEW]** リアルタイムプレビュー付き詳細設定ダイアログ
    - マウスポインタ、入力字幕、外観テーマの3つのカテゴリ別に細かくカスタマイズ可能
    - 「検証モード」により、設定ダイアログ上で実際の入力を試しながら見た目を調整可能
    - テーマ設定では、サンプル矩形を直接操作して操作感を確認可能

## 使い方:
1. `ChulipVideo.exe` を実行します。
2. 「動画を選択」からファイルを選択します。
3. シークバーや Start/End コントロールでトリミング範囲を指定します。
4. クロップ矩形を調整します。
5. 右下のボタンで「PNG保存」や「動画保存」を行います。

## 推しポイント: 
- 動画を元に編集を行うので、最初に1回だけ画面録画の操作をして、後からマニュアル作成用の切り出しに集中できるというのがポイントです。
- 先に録画してしまうのでスタートメニューや右クリックメニューを撮りたい時の煩雑さがありません。
- 映像を拡大してクロップ範囲をドット単位で指定できるので、ありがちな「ペイントに貼って微調整」が必要ありません。（たぶん）
- プリセットから利用頻度の高いクロップ範囲を数値で指定できるため、ぴったりサイズの画像の抽出が容易です。
- クロップ範囲は、GUIでマウスドラッグで選ぶことも、数値（X、Y、Width、Height）で指定することもできるので、手軽な操作と厳密な調整の両方に対応できます。
- クロップ範囲を動かさずに再生時間だけ進めれば、アプリの同じ地点の同じ大きさのスクショが取り放題です。
- PNG出力では映像の変化が止まった地点を自動選出して書き出すことが可能です。これにより録画中にしばらくマウスポインタを停止させるだけで撮影ポイントとすることができます。（でも、まだ挙動がかなり怪しいです）
- 手軽にショートカットキーやマウスクリックを演出する機能を動画へ組み込むことができます。

## 設定値: 
- トリム範囲やクロップ位置などの「動画固有の設定」は、対象動画ファイルと同じフォルダに `動画ファイルの名前.settings.json` で保存されます。
- 再生速度、圧縮率、除外設定、解像度プリセットなどの「アプリ共通設定」は、exeと同じフォルダに `ChulipVideo_config.json` で保存され、別の動画でも引き継がれます。

## その他： 
 このツールは、Excel-Fun.xls* DiscordのPython雑談部屋で `Option Explicit氏` が開発した試作品を改造したものとなります。

## 更新履歴: 
- 2026/2/8 v0.2.3 動画FPS表示、バグ修正、ボタンが反応しない不具合修正、マウス・キー入力字幕の実装、アプリ共通設定のUI変更、他窓除外録画(WGC/PrintWindow)の実装
- 2026/2/5 v0.2.2 クロップ解像度が不正確な不具合修正、UIの改善
- 2026/2/3 v0.2.0 録画機能の追加
- 2026/2/2 v0.1.0 クリップ取得ツール試作品公開

## メモ
- Python素人がAIを頼りに書いているためコード品質については期待しないでください。
- 1ファイルのexeにビルド済みなので、起動するだけで使えると思います。
